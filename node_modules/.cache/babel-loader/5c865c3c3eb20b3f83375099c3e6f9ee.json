{"ast":null,"code":"import _defineProperty from \"/Users/rafelolmos/Documents/HookTheBook/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/rafelolmos/Documents/HookTheBook/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/rafelolmos/Documents/HookTheBook/src/pages/Signup/Signup.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport FormInput from '../../components/FormInput';\nimport { signup, registerAuthObserver } from '../../services/auth';\nimport { addItemWithId, getItem } from '../../services/database';\nimport './Signup.scss';\nlet cancelObserver;\n\nconst Signup = ({\n  history\n}) => {\n  const _useState = useState({\n    name: '',\n    email: '',\n    password: ''\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        formData = _useState2[0],\n        setFormData = _useState2[1];\n\n  const _useState3 = useState(''),\n        _useState4 = _slicedToArray(_useState3, 2),\n        error = _useState4[0],\n        setError = _useState4[1];\n\n  useEffect(() => {\n    if (cancelObserver) cancelObserver();\n    cancelObserver = registerAuthObserver(async user => {\n      if (user) {\n        const profile = await getItem('profiles', user.uid);\n\n        if (!profile) {\n          const result = await addItemWithId('profiles', {\n            name: formData.name,\n            email: formData.email\n          }, user.uid);\n\n          if (result) {\n            history.push('/');\n          }\n        }\n      }\n    });\n    return () => {\n      cancelObserver();\n    };\n  }, [formData.name, formData.email]);\n\n  const handleSubmitForm = event => {\n    event.preventDefault();\n    setError('');\n    const name = formData.name,\n          email = formData.email,\n          password = formData.password;\n\n    if (!name || !email || !password) {\n      setError('Todos los campos son obligatorios');\n    } else {\n      signup(email, password);\n    }\n  };\n\n  return React.createElement(\"section\", {\n    className: \"form-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, error && React.createElement(\"div\", {\n    className: \"form-error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }, error), React.createElement(\"form\", {\n    onSubmit: handleSubmitForm,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }, React.createElement(FormInput, {\n    label: \"Name\",\n    value: formData.name,\n    onChange: value => setFormData(_objectSpread({}, formData, {\n      name: value\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }), React.createElement(FormInput, {\n    label: \"Email\",\n    value: formData.email,\n    onChange: value => setFormData(_objectSpread({}, formData, {\n      email: value\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }), React.createElement(FormInput, {\n    type: \"password\",\n    label: \"Password\",\n    value: formData.password,\n    onChange: value => setFormData(_objectSpread({}, formData, {\n      password: value\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, \"Registrar\")));\n};\n\nexport default Signup;","map":{"version":3,"sources":["/Users/rafelolmos/Documents/HookTheBook/src/pages/Signup/Signup.js"],"names":["React","useState","useEffect","FormInput","signup","registerAuthObserver","addItemWithId","getItem","cancelObserver","Signup","history","name","email","password","formData","setFormData","error","setError","user","profile","uid","result","push","handleSubmitForm","event","preventDefault","value"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,SAAP,MAAsB,4BAAtB;AAEA,SAASC,MAAT,EAAiBC,oBAAjB,QAA6C,qBAA7C;AACA,SAASC,aAAT,EAAwBC,OAAxB,QAAuC,yBAAvC;AAEA,OAAO,eAAP;AAEA,IAAIC,cAAJ;;AAEA,MAAMC,MAAM,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAiB;AAAA,oBACET,QAAQ,CAAC;AAACU,IAAAA,IAAI,EAAE,EAAP;AAAWC,IAAAA,KAAK,EAAE,EAAlB;AAAsBC,IAAAA,QAAQ,EAAE;AAAhC,GAAD,CADV;AAAA;AAAA,QACvBC,QADuB;AAAA,QACbC,WADa;;AAAA,qBAEJd,QAAQ,CAAC,EAAD,CAFJ;AAAA;AAAA,QAEvBe,KAFuB;AAAA,QAEhBC,QAFgB;;AAI9Bf,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIM,cAAJ,EAAoBA,cAAc;AAElCA,IAAAA,cAAc,GAAGH,oBAAoB,CAAC,MAAOa,IAAP,IAAgB;AACpD,UAAIA,IAAJ,EAAU;AACR,cAAMC,OAAO,GAAG,MAAMZ,OAAO,CAAC,UAAD,EAAaW,IAAI,CAACE,GAAlB,CAA7B;;AACA,YAAI,CAACD,OAAL,EAAc;AACZ,gBAAME,MAAM,GAAG,MAAMf,aAAa,CAChC,UADgC,EAEhC;AAAEK,YAAAA,IAAI,EAAEG,QAAQ,CAACH,IAAjB;AAAuBC,YAAAA,KAAK,EAAEE,QAAQ,CAACF;AAAvC,WAFgC,EAGhCM,IAAI,CAACE,GAH2B,CAAlC;;AAKA,cAAIC,MAAJ,EAAY;AACVX,YAAAA,OAAO,CAACY,IAAR,CAAa,GAAb;AACD;AACF;AACF;AACF,KAdoC,CAArC;AAgBA,WAAO,MAAM;AACXd,MAAAA,cAAc;AACf,KAFD;AAGD,GAtBQ,EAsBN,CAACM,QAAQ,CAACH,IAAV,EAAgBG,QAAQ,CAACF,KAAzB,CAtBM,CAAT;;AAwBA,QAAMW,gBAAgB,GAAIC,KAAD,IAAW;AAClCA,IAAAA,KAAK,CAACC,cAAN;AACAR,IAAAA,QAAQ,CAAC,EAAD,CAAR;AAFkC,UAI1BN,IAJ0B,GAIAG,QAJA,CAI1BH,IAJ0B;AAAA,UAIpBC,KAJoB,GAIAE,QAJA,CAIpBF,KAJoB;AAAA,UAIbC,QAJa,GAIAC,QAJA,CAIbD,QAJa;;AAMlC,QAAI,CAACF,IAAD,IAAS,CAACC,KAAV,IAAmB,CAACC,QAAxB,EAAkC;AAChCI,MAAAA,QAAQ,CAAC,mCAAD,CAAR;AACD,KAFD,MAEO;AACLb,MAAAA,MAAM,CAACQ,KAAD,EAAQC,QAAR,CAAN;AACD;AACF,GAXD;;AAaA,SACE;AAAS,IAAA,SAAS,EAAC,gBAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGG,KAAK,IAAI;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA6BA,KAA7B,CADZ,EAEE;AAAM,IAAA,QAAQ,EAAEO,gBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,SAAD;AACE,IAAA,KAAK,EAAC,MADR;AAEE,IAAA,KAAK,EAAET,QAAQ,CAACH,IAFlB;AAGE,IAAA,QAAQ,EAAEe,KAAK,IAAIX,WAAW,mBAAMD,QAAN;AAAgBH,MAAAA,IAAI,EAAEe;AAAtB,OAHhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAME,oBAAC,SAAD;AACE,IAAA,KAAK,EAAC,OADR;AAEE,IAAA,KAAK,EAAEZ,QAAQ,CAACF,KAFlB;AAGE,IAAA,QAAQ,EAAEc,KAAK,IAAIX,WAAW,mBAAMD,QAAN;AAAgBF,MAAAA,KAAK,EAAEc;AAAvB,OAHhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,EAWE,oBAAC,SAAD;AACE,IAAA,IAAI,EAAC,UADP;AAEE,IAAA,KAAK,EAAC,UAFR;AAGE,IAAA,KAAK,EAAEZ,QAAQ,CAACD,QAHlB;AAIE,IAAA,QAAQ,EAAEa,KAAK,IAAIX,WAAW,mBAAMD,QAAN;AAAgBD,MAAAA,QAAQ,EAAEa;AAA1B,OAJhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXF,EAiBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAjBF,CAFF,CADF;AAwBD,CAjED;;AAmEA,eAAejB,MAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport FormInput from '../../components/FormInput';\n\nimport { signup, registerAuthObserver } from '../../services/auth';\nimport { addItemWithId, getItem } from '../../services/database';\n\nimport './Signup.scss';\n\nlet cancelObserver;\n\nconst Signup = ({ history }) => {\n  const [formData, setFormData] = useState({name: '', email: '', password: ''});\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    if (cancelObserver) cancelObserver();\n\n    cancelObserver = registerAuthObserver(async (user) => {\n      if (user) {\n        const profile = await getItem('profiles', user.uid);\n        if (!profile) {\n          const result = await addItemWithId(\n            'profiles', \n            { name: formData.name, email: formData.email },\n            user.uid\n          );   \n          if (result) {\n            history.push('/');\n          }     \n        }        \n      }\n    })\n\n    return () => {\n      cancelObserver();\n    }\n  }, [formData.name, formData.email])\n  \n  const handleSubmitForm = (event) => {\n    event.preventDefault();\n    setError('');\n\n    const { name, email, password } = formData;\n\n    if (!name || !email || !password) {\n      setError('Todos los campos son obligatorios');\n    } else {\n      signup(email, password);\n    }\n  }\n\n  return (\n    <section className=\"form-container\">\n      {error && <div className=\"form-error\">{error}</div>}\n      <form onSubmit={handleSubmitForm}>\n        <FormInput \n          label=\"Name\" \n          value={formData.name} \n          onChange={value => setFormData({ ...formData, name: value })} \n        />\n        <FormInput \n          label=\"Email\" \n          value={formData.email} \n          onChange={value => setFormData({ ...formData, email: value })} \n        />\n        <FormInput \n          type=\"password\"\n          label=\"Password\" \n          value={formData.password} \n          onChange={value => setFormData({ ...formData, password: value })} \n        />\n        <button>Registrar</button>\n      </form>\n    </section>\n  );\n}\n \nexport default Signup;"]},"metadata":{},"sourceType":"module"}